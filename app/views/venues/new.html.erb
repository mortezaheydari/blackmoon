<div class="body">
	<div class="offering">
                    <h1><%= image_tag "event-icon.png", width: 50 %> Create New Venue</h1>
		<%= form_for(@venue) do |f| %>

                            <div>
                                <table  width="100%">
                                    <tr>
                                        <td width="135"><%= f.label :title, "Venue Title: " %></td>
                                        <td><%= f.text_field :title %></td>
                                    </tr>
                                    <tr>
                                        <td width="135"><%= f.label :descreption, "Description" %></td>
                                        <td><%= f.text_area :descreption %></td>
                                    </tr>
                                </table>
                            </div>
<hr>

                    <h2>2. Location:</h2>

                    <%= f.fields_for @location do |l| %>
                            <div>
                                <table width="100%">
                                    <tr>
                                        <td width="135"><%= l.label :city, "Select the city:" %></td>
                                        <td><%= l.select :city, ["Abdullah Al-Salem", "Adailiya", "Bnaid Al-Qar", "Daiya", "Dasma", "Dasman", "Doha", "Faiha", "Ghornata", "Jaber Al Ahmed", "Kaifan", "Khaldiya", "Kuwait City", "Mansouriya", "Mirqab", "Mubarakiya Camps", "Nuzha", "Qadsiya", "Qibla", "Qortuba", "Rawda", "Salhiya", "Shamiya", "Sharq", "Shuwaikh", "Sulaibikhat", "Surra", "Yarmouk", "Al-Bedae", "Bayan", "Hawally", "Hitteen", "Jabriya", "Maidan Hawally", "Mishrif", "Mubarak Al-Abdullah", "Rumaithiya", "Salam", "Salmiya", "Salwa", "Shaab", "Shuhada", "Siddiq", "Zahra", "Abbasiya", "Abdullah Al-Mubarak - West Jleeb", "Abraq Khaitan", "Airport", "Andalous", "Ardhiya", "Ardiya Small Industrial", "Ardiya Storage Zone", "Ashbeliah", "Dhajeej", "Exhibits - South Khaitan", "Farwaniya", "Ferdous", "Jleeb Al-Shiyoukh", "Khaitan", "Omariya", "Rabiya", "Rai", "Reggai", "Rehab", "Sabah Al-Nasser", "Sheikh Saad Al Abdullah Airport", "Abu Halifa", "Al Julayah - Az Zour Sulah", "Al-Ahmadi", "Dhaher", "East Al Ahmadi", "Egaila", "Fahad Al Ahmed", "Fahaheel", "Fintas", "Hadiya", "Jaber Al-Ali", "Magwa", "Mahboula", "Mangaf", "Mina Abdullah", "Mina Al Ahmadi", "Nuwaiseeb", "Riqqa", "Sabah Al Ahmad Marine City", "Sabah AL Ahmad residential", "Sabahiya", "Shuaiba Port", "Wafra farms", "Wafra residential", "Al Naeem", "Amgarah Industrial", "Jahra", "Kabd", "Nahda", "Nasseem", "Oyoun", "Qairawan - South Doha", "Qasr", "Saad Al Abdullah", "Sulaibiya Indutrial 1", "Sulaibiya Indutrial 2", "Sulaibiya Residential", "Sulaibiya", "Taima", "Waha", "Abu Ftaira", "Abu Hasaniya", "Adan", "Al Masayel", "Ali Sabah Al-Salem", "Al-Qurain", "Al-Qusour", "Coast Strip B", "Fnaitess", "Messila", "Mubarak Al-Kabir", "Sabah Al-Salem", "Sabhan Industrial", "South Wista", "West Abu Fetera Small Indust", "Wista"] %></td>
                                    </tr>
                                    <tr>
                                        <td width="135"><%= l.label :custom_address_use, "Use custom address:" %></td>
                                        <td><%= l.check_box :custom_address_use %></td>
                                    </tr>
                                    <tr id="address_row">
                                        <td width="135"><%= l.label :custom_address, "Address:" %></td>
                                        <td><%= l.text_field :custom_address %></td>
                                    </tr>
                                    <tr>
                                        <td width="135"><%= l.label :latitude, "latitude:" %></td>
                                        <td><%= l.text_field :latitude %></td>
                                    </tr>
                                    <tr>
                                        <td width="135"><%= l.label :longitude, "longitude:" %></td>
                                        <td><%= l.text_field :longitude %></td>
                                    </tr>
                                    <tr>
                                        <td width="135"><%= l.label :gmaps, "Use Google maps tag:" %></td>
                                        <td><%= l.check_box :gmaps %></td>
                                    </tr>
                                    <tr id="map_row">
                                        <td width="135"><label for="div">Tag a place:</label></td>
                                        <td><%= gmaps( "markers" => { "data" => @location.to_gmaps4rails, "options" => { "draggable" => true,"center_latitude" => 40, "center_longitude" => 40, "zoom" => 14 }}) %></td>
                                    </tr>
                                </table>

                            </div>
                        <% end %>


                <%= f.submit "Create the Venue", class: "button grey submitBtn homeBtn left" %>


        <% end %>
    </div>
</div>


<%= content_for :scripts do %>
    <script type="text/javascript" charset="utf-8">
      var markersArray = [];
      Gmaps.map.callback = function() {
        var marker = Gmaps.map.markers[0];
        if (marker) {
          // Move existing marker when editing a previously stored location
          google.maps.event.addListener(marker.serviceObject, 'dragend', function() {
            updateFormLocation(this.getPosition());
          });
        }

        // On click, clear markers, place a new one, update coordinates in the form
        google.maps.event.addListener(Gmaps.map.serviceObject, 'click', function(event) {
          clearOverlays();
          placeMarker(event.latLng);
          updateFormLocation(event.latLng);
        });
      };
      // Update form attributes with given coordinates
      function updateFormLocation(latLng) {
        $('#venue_location_latitude').val(latLng.lat());
        $('#venue_location_longitude').val(latLng.lng());
        $('#centre_gmaps_zoom').val(Gmaps.map.serviceObject.getZoom());
      }
      // Add a marker with an open infowindow
      function placeMarker(latLng) {
        var marker = new google.maps.Marker({
          position: latLng,
          map: Gmaps.map.serviceObject,
          draggable: true
        });
        markersArray.push(marker);
        // Set and open infowindow
        var infowindow = new google.maps.InfoWindow({
          content: ''
        });
        infowindow.open(Gmaps.map.serviceObject, marker);
        // Listen to drag & drop
        google.maps.event.addListener(marker, 'dragend', function() {
          updateFormLocation(this.getPosition());
        });
      }
      // Removes the overlays from the map, including the ones loaded with the map itself
      function clearOverlays() {
        for (var i = 0; i < markersArray.length; i++ ) {
          markersArray[i].setMap(null);
        }
        markersArray.length = 0;

        for (var i = 0; i < Gmaps.map.markers.length; i++ ) {
          Gmaps.map.clearMarker(Gmaps.map.markers[i]);
        }
      }
    </script>
<% end %>